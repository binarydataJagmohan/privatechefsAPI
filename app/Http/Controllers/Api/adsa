we are making chat  functionality in which there are three types of chat - single,booking and group chat.as you can see we are grouping on the basis of 'chat_messages.unique_booking_id', 'chat_messages.single_chat_id', 'chat_messages.group_id. in our code ,we are not able to see latest message and latest created at date at frontend.can you please start checking from the database tables that i have provded you.You can see there,last entry was 22.start checking from the last entry ,what is chat  type .If chat type is single.for instance i have a single chat type and whose single chat id is  159. continue checking if chat type = 159 matched then need to make a group and last message will be "last single chat mgs 159" and created date will be "2023-06-06 13:51:58".then it will again start checking for group and booking type also.for instance it will move to id = 21,it will check chat type,if chat type is group or booking,then it will make grouping on the basis of group id or unique booking id ,need last message and created date for these two also.
and then this loop will continue.
please modify my above code on the basis of logic what i have provided you.